<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI资讯</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<header>AI资讯</header>
<main id="news-container">加载中...</main>

<!-- 弹出全文窗口 -->
<div id="modal" class="modal">
  <div class="modal-content">
    <span id="modal-close">&times;</span>
    <div id="modal-body"></div>
  </div>
</div>

<script>
fetch('articles.json')
  .then(res => res.json())
  .then(data => {
    const container = document.getElementById('news-container');
    container.innerHTML = '';
    const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

    data.forEach(item => {
      const card = document.createElement('div');
      card.className = 'card';

      const meta = document.createElement('div');
      meta.className = 'meta';
      meta.innerHTML = `${item.source} | ${item.author} | ${item.time}
        <span class="fav" data-url="${item.url}">
          ${favorites.includes(item.url) ? '★' : '☆'}
        </span>`;

      const summary = document.createElement('div');
      summary.className = 'summary';
      summary.textContent = item.summary;

      const readBtn = document.createElement('button');
      readBtn.textContent = "阅读全文";
      readBtn.onclick = () => showModal(item.content);

      card.appendChild(meta);
      card.appendChild(summary);
      card.appendChild(readBtn);
      container.appendChild(card);
    });

    // 收藏事件
    document.querySelectorAll('.fav').forEach(favEl => {
      favEl.onclick = () => {
        const url = favEl.dataset.url;
        const idx = favorites.indexOf(url);
        if (idx >= 0) {
          favorites.splice(idx, 1);
          favEl.textContent = '☆';
        } else {
          favorites.push(url);
          favEl.textContent = '★';
        }
        localStorage.setItem('favorites', JSON.stringify(favorites));
      };
    });

    // 关闭全文弹窗
    document.getElementById('modal-close').onclick = () => {
      document.getElementById('modal').style.display = 'none';
    };
  });

function showModal(html) {
  document.getElementById('modal-body').innerHTML = html;
  document.getElementById('modal').style.display = 'block';
}
</script>
</body>
</html>
